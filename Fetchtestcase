@Override
public MiPositions getMiChallenge(Map<String, String> headerMap, String credentialStore, String partition, String credentialId) {

    if (credentialId != null && credentialStore != null && partition != null) {
        return memorableInformationRestTemplate.executeGetRequest(
                headerMap,
                MiPositions.class,
                memorableInformationProperties.getOperations().getMemorableInformationChallengeCode(),
                credentialStore,
                partition,
                credentialId
        );
    } else {
        throw new CoordinatorException(
            errorConfig.getErrorMap().get(ErrorCode.IAU_SSI_COORDINATOR_FETCH_API_ERR_101),
            "Missing required values: credentialId / credentialStore / partition"
        );
    }
}
‚úÖ Now your flow is complete:
MiChallengeServiceImpl ‚ûù implements overloaded getMiChallenge(...)

MiChallengeService interface ‚ûù declares same method

Your JUnit test can now call this with 4 args

java
Copy code
miChallengeService.getMiChallenge(headerMap, null, null, null);
üöÄ Final Tip: Fix the 4 Red Errors (Compile-Time)
Make sure:

memorableInformationRestTemplate is properly mocked in your JUnit

memorableInformationProperties.getOperations().getMemorableInformationChallengeCode() is not null

errorConfig.getErrorMap() returns a non-null map

Send me a screenshot if red underline still persists after pasting this logic ‚Äî we‚Äôll fix each one until it‚Äôs clean bro üî•

Now just 1 final step left ‚Üí rerun the test üí™








---------------------------------------------------
@ExtendWith(MockitoExtension.class)
public class MiChallengeServiceImplTest {

    @InjectMocks
    private MiChallengeServiceImpl miChallengeService;

    @Mock
    private LbgRestTemplate memorableInformationRestTemplate;

    @Mock
    private CapiMemorableInformationProperties memorableInformationProperties;

    @Mock
    private CacheMgmtProxyService cacheMgmtProxyService;

    @Mock
    private ErrorConfig errorConfig;

    // Mock response structure
    @Mock
    private JourneyState journeyState;

    // Replace JourneyConfig with just a generic configObject
    @Mock
    private Object configObject;

    @Mock
    private CredentialStore credentialStore;

    @Mock
    private ErrorResponse errorResponse;

    @Test
    void testGetMiChallenge_success() {
        // Arrange
        Map<String, String> headerMap = new HashMap<>();
        String credentialId = "abc-123";
        String credentialStoreStr = "store-1";
        String partitionStr = "partition-x";

        // Mocking journeyState.getData()
        Map<String, String> dataMap = new HashMap<>();
        dataMap.put("CREDENTIAL_ID_KEY", credentialId);
        dataMap.put("CREDENTIAL_STORE_KEY", credentialStoreStr);

        when(cacheMgmtProxyService.getJourneyStateBySessionId(headerMap)).thenReturn(journeyState);
        when(journeyState.getData()).thenReturn(dataMap);

        // Mocking journeyState.getConfig().getCredentialStores().get(0).getPartition()
        when(journeyState.getConfig()).thenReturn(configObject);
        when(((Map<?, ?>) configObject).get("credentialStores")).thenReturn(List.of(credentialStore));
        when(credentialStore.getPartition()).thenReturn(partitionStr);

        // URL
        String apiUrl = "https://test.com/mi-challenge";
        when(memorableInformationProperties.getMemorableInformationChallengeCode()).thenReturn(apiUrl);

        // Final expected response
        MiPositions mockMiPositions = new MiPositions();
        when(memorableInformationRestTemplate.executeGetRequest(
                eq(apiUrl),
                any(HttpEntity.class),
                eq(MiPositions.class),
                eq(credentialStoreStr),
                eq(partitionStr),
                eq(credentialId)
        )).thenReturn(mockMiPositions);

        // Act
        MiPositions result = miChallengeService.getMiChallenge(headerMap, null, null, null);

        // Assert
        assertNotNull(result);
        assertEquals(mockMiPositions, result);
    }

    @Test
    void testGetMiChallenge_missingValues_shouldThrowException() {
        Map<String, String> headerMap = new HashMap<>();

        when(cacheMgmtProxyService.getJourneyStateBySessionId(headerMap)).thenReturn(journeyState);
        when(journeyState.getData()).thenReturn(new HashMap<>());

        // Config returns null or bad structure
        when(journeyState.getConfig()).thenReturn(configObject);
        when(((Map<?, ?>) configObject).get("credentialStores")).thenReturn(null);

        when(errorConfig.getErrorMap()).thenReturn(Map.of(
            "IAU_SSI_COORDINATOR_FETCH_API_ERR_101", errorResponse
        ));

        assertThrows(CoordinatorException.class, () -> {
            miChallengeService.getMiChallenge(headerMap, null, null, null);
        });
    }
}
